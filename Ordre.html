<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Ordredetaljer</title>

    <script type="text/javascript">
        /*
            IIF (Immediately invoking function):
            (() => {
                HAX
            })()
        */

        (() => {

            const insertionPoint = document.getElementById('orderContainer');

            const init = () => {
                const id = $('#rightMainPage').attr('data-id');

                const order = getDataFromId(id);

                insertionPoint.appendChild(makeOrderDOM(order))

                insertionPoint.appendChild(makeProductTable(order.products))
            };

            const makeOrderDOM = data => {
                const wrapper = document.createElement('div');

                [
                    {title: 'Date', value: data.date},
                    {title: 'Order Number', value: data.id},
                    {title: 'Company', value: data.company},
                    {title: 'Total', value: data.total},
                ].reduce((reduction, item) => {
                    return reduction.appendChild(
                        makeOrderInfoItem(item.title, item.value)
                    )
                }, wrapper)

                return wrapper;
            }

            const makeProductTable = products => {

                const table = document.createElement('table');
                table.id = "ordreID";

                const header = document.createElement('thead');

                const productHeader = Object.keys(products[0]).reduce(
                    (reduction, key) => appendTd(reduction, key, true),
                    document.createElement('tr')
                )

                header.append(productHeader)

                table.append(header);

                // {title: 'banana', amount: 3, unitPrice: 20},
                const productRows = products.reduce((reduction, product) => {

                    const row = Object.values(product).reduce(
                        (rowReduction, productAttribute) => appendTd(rowReduction, productAttribute),
                        document.createElement('tr')
                    );

                    reduction.appendChild(row);

                    return reduction;
                }, document.createElement('tbody'));

                table.appendChild(productRows);

                return table;
            }

            const appendTd = (tr, text, isHeader) => {
                const d = document.createElement(isHeader ? 'th' : 'td');
                d.appendChild(
                    document.createTextNode(
                        text
                    )
                )
                tr.appendChild(d)
                return tr;
            }

            const makeOrderInfoItem = (title, value) => {
                const paragraph = document.createElement('p');

                const bold = document.createElement('b');
                bold.appendChild(document.createTextNode(title))
                const br = document.createElement('br');
                const text = document.createTextNode(value);

                paragraph.appendChild(bold);
                paragraph.appendChild(br);
                paragraph.appendChild(text);

                return paragraph;
            }

            init();
        })();
    </script>
</head>
<body>
<div id="orderContainer"></div>
</body>
</html>